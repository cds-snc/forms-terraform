{
  "name": "Terraform",
  "dockerComposeFile": "docker-compose.yml",
  "service": "iac",
  "workspaceFolder": "/workspace",
  "settings": {
    "[terraform]": {
      "editor.formatOnSave": true
    }
  },
  "features": {
    "docker-in-docker": {
      "version": "latest",
      "moby": true
    },
    "terraform": {
      "version": "1.0.10",
      "tflint": "latest",
      "terragrunt": "0.35.6"
    },
    "aws-cli": {
      "version": "2.5.6"
    }
  },

  // Add the IDs of extensions you want installed when the container is created.
  "extensions": [
    "hashicorp.terraform",
    "redhat.vscode-yaml"
  ],

  // Comment out connect as root instead. More info: https://aka.ms/vscode-remote/containers/non-root.
  "remoteUser": "vscode",
  "forwardPorts": [3001],

  // Run when devcontainer starts to add host's IP to the docker-in-docker (DinD) containers 
  "postStartCommand": "nohup bash -c '.devcontainer/scripts/dind_add_host.sh &' >/dev/null 2>&1"
}